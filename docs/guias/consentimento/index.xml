<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Stone OpenBank – CONSENTIMENTO</title>
    <link>https://stone-co.github.io/docs/guias/consentimento/</link>
    <description>Recent content in CONSENTIMENTO on Stone OpenBank</description>
    <generator>Hugo -- gohugo.io</generator>
    <lastBuildDate>Mon, 28 Jun 2021 09:00:00 -0300</lastBuildDate>
    
	  <atom:link href="https://stone-co.github.io/docs/guias/consentimento/index.xml" rel="self" type="application/rss+xml" />
    
    
      
        
      
    
    
    <item>
      <title>Docs: Overview</title>
      <link>https://stone-co.github.io/docs/guias/consentimento/overview/</link>
      <pubDate>Mon, 28 Jun 2021 09:00:00 -0300</pubDate>
      
      <guid>https://stone-co.github.io/docs/guias/consentimento/overview/</guid>
      <description>
        
        
        &lt;br&gt;
&lt;p&gt;O &lt;strong&gt;Consentimento&lt;/strong&gt; é um conceito fundamental no Open Banking, pois a partir da realização deste processo, um usuário poderá permitir o compartilhamento de suas informações entre diferentes instituições autorizadas pelo Banco Central e a movimentação de suas contas bancárias a partir de diferentes plataformas e não apenas pelo aplicativo ou site do banco, de forma segura, ágil e conveniente.&lt;/p&gt;
&lt;p&gt;Para instituições que desejem pedir consentimento a usuários da Conta Stone, basta gerar um link de consentimento em nossa API e enviar o mesmo para avaliação do usuário dono da conta.
&lt;br&gt;A partir da aprovação do usuário, a plataforma parceira terá acesso aos escopos solicitados.&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title>Docs: Fluxo de consentimento</title>
      <link>https://stone-co.github.io/docs/guias/consentimento/fluxo-de-consentimento/</link>
      <pubDate>Mon, 28 Jun 2021 09:00:00 -0300</pubDate>
      
      <guid>https://stone-co.github.io/docs/guias/consentimento/fluxo-de-consentimento/</guid>
      <description>
        
        
        &lt;br&gt;
&lt;p&gt;A partir da abertura de conta realizada pelo usuário, uma plataforma poderá solicitar acesso ao compartilhamento de informações e iniciação de pagamentos na conta de um usuário. Para isso, deverá gerar um &lt;strong&gt;Link de Consentimento&lt;/strong&gt; dentro do padrão estabelecido.&lt;/p&gt;
&lt;p&gt;Após gerar e enviar o Link ao usuário, poderão acontecer três situações, das quais o parceiro será notificado:&lt;/p&gt;
&lt;h6 id=&#34;usuário-acessa-o-link-e-dá-consentimento-ao-parceiro&#34;&gt;&lt;strong&gt;Usuário acessa o link e dá consentimento ao parceiro&lt;/strong&gt;&lt;/h6&gt;
&lt;p&gt;Ao acessar o link, o usuário será direcionado para um página da Stone em que irá escolher a quais contas de pagamento ele deseja conceder acesso ao parceiro. Ele também poderá verificar a quais escopos o parceiro passará a ter acesso após dar consentimento. Uma vez dado o consentimento, o usuário deverá ser direcionado de volta a uma página do parceiro.&lt;/p&gt;
&lt;p&gt;Veja abaixo um exemplo da tela de pedido de consentimento que será disponibilizada ao cliente:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;solicitacao-de-consentimento.png&#34; alt=&#34;solicitacao-consentimento&#34;&gt;&lt;/p&gt;
&lt;br&gt;
Veja abaixo um exemplo de permissão concedida:
&lt;p&gt;&lt;img src=&#34;consentimento-aprovado.png&#34; alt=&#34;consentimento-aprovado&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;Ao clicar no botão &amp;ldquo;Ok, entendi&amp;rdquo; o usuário será redirecionado para uma página da aplicação parceira, cujo endereço foi definido no &lt;a href=&#34;https://stone-co.github.io/docs/guias/token-de-acesso/cadastro-da-aplicacao/&#34;&gt;Cadastro da Aplicação&lt;/a&gt;.&lt;/p&gt;
&lt;br&gt;
&lt;h6 id=&#34;usuário-acessa-o-link-e-não-dá-consentimento-ao-parceiro&#34;&gt;&lt;strong&gt;Usuário acessa o link e não dá consentimento ao parceiro&lt;/strong&gt;&lt;/h6&gt;
&lt;br&gt;
&lt;p&gt;Pode acontecer também o caso em que o usuário rejeitar o consentimento solicitado. Neste caso, ele será redirecionado a uma página do parceiro. O parceiro, neste caso, não poderá acessar informações nem operar a conta do usuário.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Atenção!&lt;/strong&gt; &lt;br&gt;Em ambos os casos citados acima, faremos um redirecionamento para a URI cadastrada no token. Acrescentaremos na URI os seguintes campos:&lt;/p&gt;
&lt;br&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Chave&lt;/th&gt;
&lt;th&gt;Valor&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;session_metadata&lt;/td&gt;
&lt;td&gt;Com os mesmos os valores de passados no token.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;consent_result&lt;/td&gt;
&lt;td&gt;Indica o resultado do pedido de consentimento e pode ter os seguintes valores:&lt;br&gt;- &lt;code&gt;ignored&lt;/code&gt;: caso o usuário não dê consentimento;&lt;br&gt;- &lt;code&gt;approved&lt;/code&gt;: caso ele dê o consentimento e&lt;br&gt;- &lt;code&gt;already_granted&lt;/code&gt;: caso o consentimento desse recurso para essa aplicação já tenha sido dado anteriormente.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;resource_id&lt;/td&gt;
&lt;td&gt;Identificador do resource ao qual o consentimento foi dado. Só é retornado quando o resultado do consent é &lt;code&gt;approved&lt;/code&gt;.&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;br&gt;
&lt;p&gt;Quando o consent_result é &lt;code&gt;approved&lt;/code&gt; é enviado também o webhook consent_requested com os dados do consentimento dado. Dessa forma, você poderá prover uma experiência fluída para ambos os casos, basta validar estes campos!&lt;/p&gt;
&lt;br&gt;
&lt;h6 id=&#34;usuário-ignora-o-link&#34;&gt;&lt;strong&gt;Usuário ignora o link&lt;/strong&gt;&lt;/h6&gt;
&lt;br&gt;
&lt;p&gt;O link de consentimento tem validade de 2 horas após a sua geração. Caso o usuário não acesse o mesmo dentro desse período, será necessário gerar um novo link e fazer um novo envio.&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title>Docs: Gerando um Link de Consentimento</title>
      <link>https://stone-co.github.io/docs/guias/consentimento/gerando-um-link-de-consentimento/</link>
      <pubDate>Mon, 28 Jun 2021 09:00:00 -0300</pubDate>
      
      <guid>https://stone-co.github.io/docs/guias/consentimento/gerando-um-link-de-consentimento/</guid>
      <description>
        
        
        &lt;br&gt;
&lt;p&gt;Após cadastrar e autenticar a sua aplicação, você está apto a pedir consentimento aos seus clientes que tenham realizado a abertura de uma conta Stone. Ressaltamos que toda interação com o usuário neste processo será gerida por nossa plataforma.&lt;/p&gt;
&lt;p&gt;Seguindo os parâmetros descritos abaixo, você deverá enviar o link ao usuário por meio da sua aplicação.
&lt;br&gt;O link de consentimento deve ser enviado dentro da própria aplicação. Você pode, por exemplo, disponibilizar um botão em sua plataforma para que o usuário acesse o link. Este link não deve ser enviado ao usuário por e-mail sob hipótese alguma.&lt;/p&gt;
&lt;br&gt;
&lt;h5 id=&#34;parâmetros-do-link-de-consentimento&#34;&gt;&lt;strong&gt;Parâmetros do link de consentimento&lt;/strong&gt;&lt;/h5&gt;
&lt;p&gt;O link de consentimento deverá conter três parâmetros:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;client_id: o ClientID recebido pelo desenvolvedor pós-cadastro;&lt;/li&gt;
&lt;li&gt;type: no caso, será sempre o valor “consent”;&lt;/li&gt;
&lt;li&gt;jwt: será um token gerado localmente pelo desenvolvedor com a mesma chave privada e algoritmo que ele usa para se autenticar. Mais detalhes abaixo.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Com estes parâmetros, basta gerar um link no seguinte formato (por ambiente), substituindo CLIENT_ID e JWT por seus respectivos valores:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Sandbox&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://sandbox.conta.stone.com.br/consentimento?client_id=CLIENT_ID&amp;amp;jwt=JWT&#34;&gt;https://sandbox.conta.stone.com.br/consentimento?client_id=CLIENT_ID&amp;amp;jwt=JWT&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Produção&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://conta.stone.com.br/consentimento?client_id=CLIENT_ID&amp;amp;jwt=JWT&#34;&gt;https://conta.stone.com.br/consentimento?client_id=CLIENT_ID&amp;amp;jwt=JWT&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;br&gt;
&lt;p&gt;Assim como fizemos o processo de gerar um Token de Acesso autenticado, também será gerado um JWT para pedido do Consentimento.&lt;/p&gt;
&lt;br&gt;
&lt;h5 id=&#34;especificações-do-jwt-para-pedir-consentimento&#34;&gt;&lt;strong&gt;Especificações do JWT para pedir consentimento&lt;/strong&gt;&lt;/h5&gt;
&lt;br&gt;
&lt;p&gt;&lt;strong&gt;Header&lt;/strong&gt;
&lt;br&gt;Observe que é preciso assinar o token JWT com a chave privada da aplicação e o algoritmo RS256, assim como é feito para o token de autenticação. Dessa forma, neste token também é preciso incluir um header com as informações sobre o algoritmo de criptografia utilizado, entre outros metadados, como um id da chave utilizada. Por exemplo:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;{
  &lt;span style=&#34;color:#ff79c6&#34;&gt;&amp;#34;alg&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#f1fa8c&#34;&gt;&amp;#34;RS256&amp;#34;&lt;/span&gt;,
  &lt;span style=&#34;color:#ff79c6&#34;&gt;&amp;#34;typ&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#f1fa8c&#34;&gt;&amp;#34;JWT&amp;#34;&lt;/span&gt;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br&gt;
&lt;p&gt;&lt;strong&gt;Payload&lt;/strong&gt;
&lt;br&gt;O token deve conter os claims abaixo:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Campos  &lt;strong&gt;Obrigatórios&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;Descrição&lt;/th&gt;
&lt;th&gt;Tipo&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;type&lt;/td&gt;
&lt;td&gt;Será sempre &amp;ldquo;consent&amp;rdquo; neste caso.&lt;/td&gt;
&lt;td&gt;&lt;em&gt;String&lt;/em&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;client_id&lt;/td&gt;
&lt;td&gt;Será o ClientID da Aplicação Parceira.&lt;/td&gt;
&lt;td&gt;&lt;em&gt;String&lt;/em&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;redirect_uri&lt;/td&gt;
&lt;td&gt;A URI para redirecionamento após a ação do usuário. Esta URI foi informada previamente no cadastro da Aplicação Parceira. Caso seja enviada uma URI diferente, retornará erro.&lt;/td&gt;
&lt;td&gt;&lt;em&gt;String&lt;/em&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;session_metadata&lt;/td&gt;
&lt;td&gt;Um objeto que contenha qualquer chave relevante para o parceiro identificar a sessão do usuário. Este valor estará presente na URI de redirecionamento e não pode ser nulo ou um mapa vazio.&lt;/td&gt;
&lt;td&gt;&lt;em&gt;Objeto&lt;/em&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;iss&lt;/td&gt;
&lt;td&gt;Usar o client_id da Aplicação.&lt;/td&gt;
&lt;td&gt;&lt;em&gt;String&lt;/em&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;iat&lt;/td&gt;
&lt;td&gt;Momento em que o token foi gerado. É um timestamp UTC. Exemplo: &amp;ldquo;iat&amp;rdquo;: 1542235633.&lt;/td&gt;
&lt;td&gt;&lt;em&gt;Int&lt;/em&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;aud&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;mailto:accounts-hubid@openbank.stone.com.br&#34;&gt;accounts-hubid@openbank.stone.com.br&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;&lt;em&gt;String&lt;/em&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;jti&lt;/td&gt;
&lt;td&gt;Identificador único do token gerado. Normalmente se utiliza um UUID.&lt;/td&gt;
&lt;td&gt;&lt;em&gt;String&lt;/em&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;nbf&lt;/td&gt;
&lt;td&gt;É o momento em que o token passa a ser válido. Na maioria dos casos terá o mesmo valor que iat (issued at) pois queremos que ele esteja válido logo a partir do momento de geração.&lt;/td&gt;
&lt;td&gt;&lt;em&gt;Int&lt;/em&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;exp&lt;/td&gt;
&lt;td&gt;Momento de expiração do token em segundos desde o início da era UNIX (1970). É um timestamp UTC e não pode ser maior que 2 horas. Exemplo: &amp;ldquo;exp&amp;rdquo;: 1542235633&lt;/td&gt;
&lt;td&gt;&lt;em&gt;Int&lt;/em&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;br&gt;
&lt;p&gt;Segue um exemplo de como ficariam os claims preenchidos:&lt;/p&gt;
&lt;br&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;{
  &lt;span style=&#34;color:#ff79c6&#34;&gt;&amp;#34;type&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#f1fa8c&#34;&gt;&amp;#34;consent&amp;#34;&lt;/span&gt;,
  &lt;span style=&#34;color:#ff79c6&#34;&gt;&amp;#34;client_id&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#f1fa8c&#34;&gt;&amp;#34;MY CLIENT ID&amp;#34;&lt;/span&gt;, 
  &lt;span style=&#34;color:#ff79c6&#34;&gt;&amp;#34;iss&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#f1fa8c&#34;&gt;&amp;#34;MY CLIENT ID&amp;#34;&lt;/span&gt;,
  &lt;span style=&#34;color:#ff79c6&#34;&gt;&amp;#34;redirect_uri&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#f1fa8c&#34;&gt;&amp;#34;https://mypreviouslyregistereduri.com&amp;#34;&lt;/span&gt;,
  &lt;span style=&#34;color:#ff79c6&#34;&gt;&amp;#34;session_metadata&amp;#34;&lt;/span&gt;: {
    &lt;span style=&#34;color:#ff79c6&#34;&gt;&amp;#34;user_session&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#f1fa8c&#34;&gt;&amp;#34;xxxxxxxxxxxxxxxxxxxxx&amp;#34;&lt;/span&gt;,
  },
  &lt;span style=&#34;color:#ff79c6&#34;&gt;&amp;#34;iat&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#bd93f9&#34;&gt;1542235633&lt;/span&gt;,
  &lt;span style=&#34;color:#ff79c6&#34;&gt;&amp;#34;nbf&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#bd93f9&#34;&gt;1542235633&lt;/span&gt;,
  &lt;span style=&#34;color:#ff79c6&#34;&gt;&amp;#34;exp&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#bd93f9&#34;&gt;1549069563&lt;/span&gt;,
    &lt;span style=&#34;color:#ff79c6&#34;&gt;&amp;#34;jti&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#f1fa8c&#34;&gt;&amp;#34;41e8aa9f-bb9c-4fd2-9953-2595dbbd5a83&amp;#34;&lt;/span&gt;,
  &lt;span style=&#34;color:#ff79c6&#34;&gt;&amp;#34;aud&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#f1fa8c&#34;&gt;&amp;#34;accounts-hubid@openbank.stone.com.br&amp;#34;&lt;/span&gt;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
      </description>
    </item>
    
  </channel>
</rss>
